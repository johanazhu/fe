# 模拟题七



## 1.双飞翼/圣杯布局

考察点：双飞翼/圣杯布局

双飞翼布局：浮动+margin-left+中间部分再包裹一层

圣杯布局：浮动+margin-left+自身相对定位





## 2. 手写 reduce





## 3.什么是立即执行函数

考察点：立即执行函数

IIFE，立即执行函数，声明一个匿名函数，并马上调用这个匿名函数。只有一个作用，创建一个独立的作用域



## 4.Map 和 Set





## 5.说说你对react的理解/请说一下react的渲染过程

首先，React 现在都用 React Fiber 架构。他实现了 React 组件的异步可中断效果

基于这个架构，我们可以把 React 渲染分为两个阶段，即 render 阶段和 commit 阶段

render 阶段就是找虚拟 DOM 中变化的部分，创建 DOM，打上增删改的标记，并把这些标记记录到 effectList 队列中

这个阶段可以被打断，由 schedule 调度，它会根据你的优先级权重值决定先执行还是后执行

等全部计算完后，就一次性更新到 DOM

渲染到 DOM 的阶段称为 commit 阶段，这个阶段即把之前记录的更新点更新到 DOM 上

它也有三个小阶段，即 before mutation、mutation 和 layout

before mutation 会异步调用 useEffect 的回调函数

mutation 阶段会遍历 effectList 更新 DOM

layout 阶段会同步调用 useLayoutEffect 的回调函数，还能拿到最新的 dom

## 6. useEffect 第二个参数是对象如何处理

考察点：useEffect 的使用

**保持依赖项为数组**

```jsx
const [state, setState] = useState({ a: 1, b: 2 });

useEffect(() => {
    // 处理副作用
    console.log("状态改变了", state);
}, [state.a, state.b]);  // 依赖项数组应包含对象的具体属性
```

**使用 JSON.stringify**

```jsx
const [state, setState] = useState({ a: 1, b: 2 });

useEffect(() => {
    // 处理副作用
    console.log("状态改变了", state);
}, [JSON.stringify(state)]);  // 使用 JSON.stringify 作为依赖项
```

**使用自定义钩子**

写个类似 useSetState 这样的 hooks，判断复杂对象的变化





## 7.遇到白屏问题如何分析和解决



检测白屏：

1. 检测页面关键DOM的是否渲染

2. 通用的DOM渲染监听

3. H5截图（canvas绘图）检测

4. native截图（容器截屏）检测

5. 利用performance.getEntries("paint")获取fp/fcp来感知渲染

原因分析：

1. 网络状态
2. 脚本报错
3. js，css和浏览器或者webview兼容性问题

解决方案：

1. 骨架屏
2. 启用服务端渲染SSR
3. 首屏静态html
4. 离线包或者PWA





为了解决单页应用的白屏问题，可以采用以下优化方法：

- **代码分割**：将 JavaScript 和 CSS 分为多个较小的文件，按需加载，减少初始加载时间
- **懒加载和预加载**：对于非关键的资源，可以采用懒加载或预加载策略，确保需要的资源先加载。
- **优化请求**：通过合并请求或使用CDN加速文件传输，减少网络延迟。
- **使用骨架屏或加载指示**：在内容加载之前显示骨架屏或加载动画，以改善用户体验。
- **监测和分析**：使用工具监测应用的性能，通过分析用户反馈不断优化加载时间





衍生：如何减少白屏时间、怎么提高项目的首屏加载速度、单页面应用为什么会有白屏



### 如何减少白屏时间



### 怎么提高项目的首屏加载速度

预渲染技术、骨架屏技术



### 单页面应用为什么会有白屏

单页应用（SPA）中的白屏现象通常指的是在用户访问应用时，页面长时间显示空白而没有任何内容，这种现象会严重影响用户体验。白屏问题的原因一半包括以下几点：

1. 初始加载时间长
   - **资源未能及时加载**：单页应用通常多个资源，如 JavaScript、CSS 和其他静态文件。如果这些资源的加载时间过长，用户在应用初始化时可能会看到白屏
   - **大文件体积**：如果加载的 JavaScript 文件体积庞大，尤其是包含了大量业务逻辑，那么在下载、解析和执行过程中可能会出现明显的延迟
2. JavaScript 执行时间长
   - **主线程占用过长**：单页应用的首次加载通常需要执行大量的 JavaScript 代码。如果没有优化，执行时间过长，则会阻塞页面渲染，导致用户看到白屏现象
   - **资源请求阻塞**：当JavaScript代码在执行过程中发起额外的网络请求，如果这些请求未能及时完成，会导致页面渲染延迟
3. 依赖问题
   - **异步数据请求失败**：单页应用通常依赖于异步请求来获取数据。如果请求失败或者返回的数据不符合预期，应用可能无法渲染任何内容，从而导致白屏。
   - **库或框架加载问题**：如果使用的框架或库加载失败，例如Vue、React等的组件未能初始化成功，也会出现白屏。



## 8.网站首页有大量的图片，加载很慢，如何优化呢？

考察点：大量图片优化

图片懒加载，显示的图片显示出来，还没出现的图片先用小图标展示

图片放在 oss 上

最开始用placeholder图或者loading图来代替，真正的图片放在data-img属性上，等到图片需要展示的时候再替换img.src

监听所有scroll，为了性能，200ms 拉动一次

循环所有的图片，判断他们的偏移高度与视窗高度+滚动高度之和，如果小于，则说明图片已经显示在视图中，那么就展示

通过 getBoundingClientRect，也是循环所有图片，但是是通过拿到该元素的getBoundingClientRect 来判断是否出现再视图中

intersectionObserver 交叉观察器，异步



## 9.Taro 的工作原理

Taro 在编译过程中，会将 React 代码解析成 AST 语法树





## 10.算法题：全排列

考察点：全排列

