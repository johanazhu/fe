# HTTP 是什么

HTTP 是什么，HTTP 又不是什么？

你是怎么理解 HTTP 字面上的“超文本”和“传输协议”的？

能否谈一下你对 HTTP 的认识？越多越好。

HTTP 有什么特点？有什么优点和缺点？

HTTP 下层都有哪些协议？是如何工作的？

http
http 的历程
http0.9 http1.0 http1.1 http2 http3 https http 缓存
http 状态码
http0.9
最开始，限制
http1.0

http1.1
真正意义上的 http

http2
多路复用

http3

http 优化
使用 http 缓存

http 缓存
强缓存
协商缓存

先强缓存，后协商缓存，协商缓存返回 304 重定向
http 状态码

-   301 永久重定向
-   302 临时重定向
-   304 协商缓存重定向
-   404 访问不到资源
-   500 服务器错误

## 答案

http

http 的历程

http0.9 http1.0 http1.1 http2 http3 https http 缓存

http 状态码

http1.0

-   没有 connection：keep-alive；
-   每次发送请求，都要链接一个 TCP

http1.1

-   加了 connection：keep-alive，复用一个 TCP 连接

-   优点（特点）

    -   长连接（持久连接）：响应头中设置 keep-alive，可以在一个 TCP 连接上发送多个 HTTP 请求
    -   浏览器为每个域名最多同时维护 6 个 TCP 连接
    -   使用 CDN 实现域名分片机制

-   存在的问题
    -   对带宽的利用率并不理想（三个主要原因）
        -   TCP 的慢启动
        -   多条 TCP 连接竞争带宽
        -   队头阻塞（主因）
            -   工作流程是请求-响应，请求发出去等待响应，然后在发送下一次请求。队头请求处理太慢，就会阻塞后面的请求处理
            -   发起了请求，但是响应还没回应，引起了“塞车”
    -   （队头阻塞）解决方法：
        -   并发连接（多建立几个 TCP 连接）
            -   同一个服务器，最多建立 6 个连接
        -   域名分片
            -   多几个域名
            -   例如：把图片资源、js、css 分别部署在 10 个服务器，可以同时下载 60 个文件
        -   多路复用
            -   HTTP2 解决方案

http2

-   解决 http1.1 的队头阻塞问题，让同一个 TCP 连接上发送所有 HTTP 请求

-   优点：
    -   多路复用
        -   相同域名多个请求，共享同一个 TCP 连接
    -   请求优先级
        -   给每个 request 设置优先级
    -   二进制传输：之前是纯文本
    -   数据流：每个请求和影响都当作一个流，
    -   服务器推送：可以主动向客户端发送消息
    -   头部压缩：减少包的大小和数量
-   缺点：
    -   还是会存在队头阻塞，不过是 TCP 的队头阻塞，解决方案 HTTP3

http3

-   TCP 会丢包
-   一旦 TCP 层出现丢包，依然会出现队头阻塞问题（Stream 丢失），所以 GOOGLE 提出了 QUIC 协议，HTTP2 就升级为 HTTP3，不过 QUIC 是基于 UDP 实现的，从根本上解决了队头阻塞的问题

#### http 与 https 有什么区别

-   http 是明文传输协议，https 是 ssl +http 协议构建的可进行加密传输、身份认真的网络协议，比 http 协议安全
-   https 比 http 更加安全，搜索引擎对其更友好，利于 SEO
-   https 需要 ssl 证书，http 不用
-   https 端口是 443，http 端口是 80
-   https 是基于传输层，http 是基于应用层
-   https 在浏览器上会显示安全锁，http 没有，且部分网站浏览器会提示不安全

http 性能优化

使用 http 缓存

http 缓存

强缓存

协商缓存

先强缓存，后协商缓存，协商缓存返回 304 重定向

http 状态码

-   204 无内容，服务器成功处理请求，但没有返回任何内容
-   301 永久重定向
-   302 临时重定向
-   304 协商缓存重定向
-   400 请求中语法错误
-   401 未授权
-   403 服务其收到请求，但是拒绝提供服务求，即资源不可用
-   404 无法找到请求资源
-   414 请求 uri 过长
-   500 服务器错误
-   502 网关错误
-   503 服务器不可用
-   504 网关超时

网络层面的性能优化

如果是 http1.1 下

减少 http 请求

静态资源使用 CDN

善用缓存

-   为了最大程度利用缓存，将页面入口(HTML)设置为协商缓存，将 JavaScript、CSS 等静态资源设置为永久强缓存
-   通过 max-age 和 no-cache 实现文件精准缓存
-   -   将 index.html 设置成 no-cache

压缩文件大小

-   gzip
