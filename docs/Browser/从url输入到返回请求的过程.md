# 从url输入到返回请求的过程







![从输入url到渲染起始图](../.vuepress/public/images/Browser/从输入url到渲染起始图.png)



第一步：处理输入

​	url敲入，判断它是字符串还是url，字符串的话使用浏览器默认的搜索引擎搜索，跳转页面

​	如果是url的话，先去找缓存

​	-本地缓存查找

​	beforeunload 事件

第二步：开始导航

​	网络线程进行 DNS 查询、建立 TLS 连接（对于 HTTPS ）。。。

第三步：读取响应

​	服务器返回的响应体到来之后，网路线程会检查接收到的前几个字节。如果是 HTML、CSS、JavaScript 文件，那下一步就是把数据交给渲染器进程，如果是一个 zip 文件或其他文件，那就意味着是一个下载请求，需要把数据传给下载管理器

第四步：联系渲染器进程

第五步：提交导航

第六步：初始化加载完成



这个过程可以大致描述为如下：

- 首先，用户从浏览器进程里输入请求信息
- 然后，网络进程发起 URL 请求
  - DNS 查找
  - 请求建立 TLS 连接
  - 这里可能还会又 301 重定向
- 服务器响应 URL 请求之后，浏览器进程就又要开始准备渲染进程了
- 



![从输入url到渲染过程图](../.vuepress/public/images/Browser/从输入url到渲染过程图.png)









































































渲染进程内部包含主线程、工作线程、合成线程和光栅线程

















### 参考资料

[浏览器工作原理](https://time.geekbang.org/column/article/118826)

[[译] 现代浏览器内部揭秘（第一部分）](https://juejin.cn/post/6844903679389073415)

[[译] 现代浏览器内部揭秘（第二部分）](https://juejin.cn/post/6844903692890537992)

[[译] 现代浏览器内部揭秘（第三部分）](https://juejin.cn/post/6844903692894732295)

[[译] 现代浏览器内部揭秘（第四部分）](https://juejin.cn/post/6844903695600058375)





### Q&A

Q:老师，在做前端页面的时候，是否可以设置当前页面是否可以被缓存，以及哪些部分可以被缓存？还是说整个缓存机制都是由浏览器自己控制的？

A:作者回复: 是没有办法通过前端代码来控制缓存的，缓存是后端或者部署的同学来控制的，但是前端同学应该知道那些内容要被缓存，和后端或者部署的同学配合来打！



Q:请问：请求行和请求头是发送两次吗？ 从文章的文字来看，是发送两次。 但我感觉是发送一次，即发送一次请求，该请求包含请求行和请求头。

A:作者回复: 对，只发送一次。

问下文章什么地方让你感觉是发送了两次啊？

我检查下。



Q:老师您好，我有2个问题：1，浏览器缓存DNS的解析结果，这个缓存是缓存到浏览器进程中吗？是不是浏览器关闭后浏览器的这个DNS的缓存也一起清除了？2，浏览器打开某个站点页面后，这个页面里面还有很多的域名需要解析例如一些图片的链接，这些解析结果都会缓存吗？

A:作者回复: 第一个问题：dns缓存是保存浏览器本地的，下次启动依然有结果！

第二个问题：图片和其他域名都一样的，都会缓存的