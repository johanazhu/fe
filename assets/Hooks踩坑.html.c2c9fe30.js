import{_ as p,r as t,o,c,a as n,d as a,F as l,e as r,b as e}from"./app.873f0dc8.js";const u={},i=r(`<h1 id="hooks-\u8E29\u5751\u2014\u2014capture-value" tabindex="-1"><a class="header-anchor" href="#hooks-\u8E29\u5751\u2014\u2014capture-value" aria-hidden="true">#</a> Hooks \u8E29\u5751\u2014\u2014Capture Value</h1><h3 id="capture-value" tabindex="-1"><a class="header-anchor" href="#capture-value" aria-hidden="true">#</a> Capture Value</h3><p>\u53EF\u4EE5\u7406\u89E3\u4E3A\u5FEB\u7167</p><p>\u51FD\u6570\u5728\u6BCF\u6B21\u6E32\u67D3\u65F6\u4E5F\u662F\u72EC\u7ACB\u7684\u3002\u8FD9\u5C31\u662F <strong>Capture Value</strong> \u7279\u6027</p><p>React.Hooks \u7684\u672C\u8D28\u662F\u5229\u7528\u4E86\u95ED\u5305\u673A\u5236</p><p>\u7B80\u6613\u624B\u5199 React Hooks</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> memorizedState <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// \u5B58\u653Ehooks</span>
<span class="token keyword">let</span> cursor <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token parameter">intialState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    memorizedState<span class="token punctuation">[</span>cursor<span class="token punctuation">]</span> <span class="token operator">=</span> memorizedState<span class="token punctuation">[</span>cursor<span class="token punctuation">]</span> <span class="token operator">||</span> initialState<span class="token punctuation">;</span>
    <span class="token keyword">const</span> currentCursor <span class="token operator">=</span> cursor<span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">newState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        memorizedState<span class="token punctuation">[</span>currentCuror<span class="token punctuation">]</span> <span class="token operator">=</span> newState<span class="token punctuation">;</span>
        <span class="token comment">// render \u7684\u610F\u601D\u5C31\u662F\u544A\u8BC9react\uFF0C\u53EF\u4EE5\u505Adiff\u4E86\uFF0Cdiff\u4E4B\u540E\u89C6\u56FE\u66F4\u65B0</span>
        <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// \u8FD4\u56DE setState, setState\u7684\u4F5C\u7528\u57DF\u94FE\u4E0A\u6709currentCursor\u53D8\u91CF\uFF0C\u6240\u4EE5\u65E0\u6CD5\u91CA\u653E\uFF0C\u5F62\u6210\u95ED\u5305</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>memorizedState<span class="token punctuation">[</span>cursor<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">,</span> setState<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token punctuation">[</span>show<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>\u95ED\u5305\u5F15\u8D77\u4E86\u72B6\u6001\u4E0D\u80FD\u66F4\u65B0</p><h3 id="\u5982\u4F55\u7ED5\u8FC7-capture-value" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u7ED5\u8FC7-capture-value" aria-hidden="true">#</a> \u5982\u4F55\u7ED5\u8FC7 Capture Value</h3><div class="language-react ext-react line-numbers-mode"><pre class="language-react"><code>const [flag, setFlag] = useState(false)
function handleClick() {
    setFlag(!flag);

    timer = setTimeout(() =&gt; {
        setFlag(!flag);
    }, 2000);
}
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>\u9996\u6B21\u70B9\u51FB\u6309\u94AE\u540E\uFF0C\u4EA7\u751F\u4E00\u4E2A\u5FEB\u7167 \uFF1A</p><div class="language-react ext-react line-numbers-mode"><pre class="language-react"><code>// ...
falg = false;

function handleClick() {
    setFlag(true);

    timer = setTimeout(() =&gt; {
        setFlag(true);
    }, 2000);
}
// ...
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>\u6240\u4EE5\uFF0C2s \u540E flag \u4F9D\u7136 true\u3002</p><p>\u8981\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\uFF0C\u5F88\u5BB9\u6613\u60F3\u5230\u628A\u4E0A\u6B21\u7684\u72B6\u6001\u4FDD\u5B58\u8D77\u6765\u3002</p><h3 id="\u600E\u4E48\u7406\u89E3\u8FD9\u4E2A\u5FEB\u7167" tabindex="-1"><a class="header-anchor" href="#\u600E\u4E48\u7406\u89E3\u8FD9\u4E2A\u5FEB\u7167" aria-hidden="true">#</a> \u600E\u4E48\u7406\u89E3\u8FD9\u4E2A\u5FEB\u7167</h3><p>\u5148\u770B\u770B\u8FD9\u4E2A\u666E\u901A\u51FD\u6570\u7684\u7C7B\u4F3C\u7684\u884C\u4E3A\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">sayHi</span><span class="token punctuation">(</span><span class="token parameter">person</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> name <span class="token operator">=</span> person<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;Hello,&#39;</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> someone <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;Johan&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">sayHi</span><span class="token punctuation">(</span>someone<span class="token punctuation">)</span><span class="token punctuation">;</span>

someone <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;elaine&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">sayHi</span><span class="token punctuation">(</span>someone<span class="token punctuation">)</span><span class="token punctuation">;</span>

someone <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;xiaowo&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">sayHi</span><span class="token punctuation">(</span>someone<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Hello, johan</span>
<span class="token comment">// Hello, elaine</span>
<span class="token comment">// Hello, xiaowo</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>\u8FD9\u4E2A\u4F8B\u5B50\u79CD\uFF0C\u5916\u5C42\u7684<code>someone</code> \u4F1A\u88AB\u8D4B\u503C\u5F88\u591A\u6B21\uFF08\u5C31\u50CF\u5728 React \u4E2D\uFF0C\u5F53\u524D\u7684\u72B6\u6001\u4F1A\u6539\u53D8\u4E00\u6837\uFF09</p><p>\u5F62\u6210\u5FEB\u7167\uFF0C2s \u4E4B\u540E\u7684\u662F\u6309\u7167 2 \u79D2\u524D\u7684\u52A8\u4F5C\u6267\u884C</p><p>\u6240\u4EE5\u4EA7\u751F Capture Value \u7684\u539F\u56E0\uFF0C\u6B63\u662F\u6BCF\u4E00\u6B21 re-render \u7684\u65F6\u5019\uFF0C\u90FD\u662F\u91CD\u65B0\u53BB\u6267\u884C\u51FD\u6570\u7EC4\u4EF6\u4E86\uFF0C\u5BF9\u4E8E\u4E4B\u524D\u5DF2\u7ECF\u6267\u884C\u8FC7\u7684\u51FD\u6570\u7EC4\u4EF6\uFF0C\u5E76\u4E0D\u4F1A\u505A\u4EFB\u4F55\u64CD\u4F5C</p><p>\u5229\u7528 <code>useRef</code> \u5C31\u53EF\u4EE5\u7ED5\u8FC7 Capture Value \u7684\u7279\u6027\u3002<strong>\u53EF\u4EE5\u8BA4\u4E3A <code>ref</code> \u5728\u6240\u6709 Render \u8FC7\u7A0B\u4E2D\u4FDD\u6301\u7740\u552F\u4E00\u5F15\u7528\uFF0C\u56E0\u6B64\u6240\u6709\u5BF9 <code>ref</code> \u7684\u8D4B\u503C\u6216\u53D6\u503C\uFF0C\u62FF\u5230\u7684\u90FD\u53EA\u6709\u4E00\u4E2A\u6700\u7EC8\u72B6\u6001</strong>\uFF0C\u800C\u4E0D\u4F1A\u5728\u6BCF\u4E2A Render \u95F4\u5B58\u5728\u9694\u79BB\u3002</p><p>**\u5728\u4EFB\u610F\u4E00\u6B21\u6E32\u67D3\u4E2D\uFF0Cprops \u548C state \u662F\u59CB\u7EC8\u4FDD\u6301\u4E0D\u53D8\u7684\u3002**\u5982\u679C props \u548C state \u5728\u4E0D\u540C\u7684\u6E32\u67D3\u4E2D\u662F\u76F8\u4E92\u72EC\u7ACB\u7684\uFF0C\u90A3\u4E48\u4F7F\u7528\u5230\u5B83\u4EEC\u7684\u4EFB\u4F55\u503C\u4E5F\u662F\u72EC\u7ACB\u7684\uFF08\u5305\u62EC\u4E8B\u4EF6\u5904\u7406\u51FD\u6570\uFF09\u3002\u5B83\u4EEC\u90FD\u201C\u5C5E\u4E8E\u201D\u4E00\u6B21\u7279\u5B9A\u7684\u6E32\u67D3\u3002\u5373\u4FBF\u662F\u4E8B\u4EF6\u5904\u7406\u4E2D\u7684\u5F02\u6B65\u51FD\u6570\u8C03\u7528\u201C\u770B\u5230\u201D\u7684\u4E5F\u662F\u8FD9\u6B21\u6E32\u67D3\u4E2D\u7684<code>count</code>\u503C\u3002</p><h2 id="\u53C2\u8003\u8D44\u6599" tabindex="-1"><a class="header-anchor" href="#\u53C2\u8003\u8D44\u6599" aria-hidden="true">#</a> \u53C2\u8003\u8D44\u6599</h2>`,23),k={href:"https://mp.weixin.qq.com/s/eyFKOi3PTux6aTF0s557Rg",target:"_blank",rel:"noopener noreferrer"},b=e("React Hooks \u8E29\u5751\u4E4B-- Capture Value \u7279\u6027"),m={href:"https://overreacted.io/zh-hans/a-complete-guide-to-useeffect/",target:"_blank",rel:"noopener noreferrer"},d=e("useEffect \u5B8C\u6574\u6307\u5357"),h={href:"https://juejin.cn/post/6844903806090608647#heading-5",target:"_blank",rel:"noopener noreferrer"},f=e("\u7CBE\u8BFB\u300AuseEffect \u5B8C\u5168\u6307\u5357\u300B");function g(_,v){const s=t("ExternalLinkIcon");return o(),c(l,null,[i,n("ul",null,[n("li",null,[n("p",null,[n("a",k,[b,a(s)])])]),n("li",null,[n("p",null,[n("a",m,[d,a(s)])])]),n("li",null,[n("p",null,[n("a",h,[f,a(s)])])])])],64)}var x=p(u,[["render",g],["__file","Hooks\u8E29\u5751.html.vue"]]);export{x as default};
